/*!
 * uu5g04 library with basic visual components
 * Copyright (C) 2021 Unicorn a.s.
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see Licenses - GNU Project <https://gnu.org/licenses/>.
 */
"use strict";
(this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] = this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] || []).push([["bricks_internal_block-editable_js"],{

/***/ "./bricks/internal/block-editable.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Block": () => (/* binding */ Block),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../../node_modules/uu_appg01_devkit/node_modules/@babel/runtime/helpers/extends.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./bricks/internal/bricks-editable-ns.js");
/* harmony import */ var _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./bricks/internal/bricks-editable-lsi.js");
/* harmony import */ var _css_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./bricks/internal/css.js");
/* harmony import */ var _color_picker_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./bricks/internal/color-picker.js");

/**
 * Copyright (C) 2021 Unicorn a.s.
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
 * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License at
 * <https://gnu.org/licenses/> for more details.
 *
 * You may obtain additional information at <https://unicorn.com> or contact Unicorn a.s. at address: V Kapslovne 2767/2,
 * Praha 3, Czech Republic or at the email: info@unicorn.com.
 */

//@@viewOn:imports





//@@viewOff:imports

const DEFAULT_PROPS_MAP = {
  contentEditable: false,
  colorSchema: "default",
  content: null,
  children: null,
  background: false
};
const MAIN_CLASS_NAME = _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__["default"].css("block");
const NAME = _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__["default"].name("Block");
const Block = uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.VisualComponent.create({
  displayName: NAME,
  //@@viewOn:mixins
  mixins: [uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.BaseMixin],
  //@@viewOff:mixins

  //@@viewOn:statics
  statics: {
    tagName: NAME,
    classNames: {
      main: MAIN_CLASS_NAME,
      checkbox: () => _css_js__WEBPACK_IMPORTED_MODULE_4__["default"].css(`
          cursor: pointer;
          margin-top: 0px;
          width: 100%;

          &:hover {
            background-color: #EEEEEE;
          }

          &:first-child {
            margin-top: 4px;
          }

          &:last-child {
            margin-bottom: 4px;
          }

          .uu5-forms-checkbox-button.uu5-forms-checkbox-button.uu5-forms-checkbox-button {
            border-color: transparent;
            background-color: transparent;
            outline: none;
          }

          label {
            cursor: pointer;
          }

          .uu5-forms-label {
            width: 80%;

            + .uu5-forms-input-wrapper {
              width: 20%;
            }
          }
        `)
    },
    lsi: () => ({
      ..._bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"].block,
      ..._bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"].common
    })
  },
  //@@viewOff:statics

  //@@viewOn:propTypes
  propTypes: {
    component: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.object.isRequired
  },
  //@@viewOff:propTypes

  //@@viewOn:getDefaultProps
  getDefaultProps() {
    return {
      component: null
    };
  },
  //@@viewOff:getDefaultProps

  //@@viewOn:reactLifeCycle
  getInitialState() {
    this._defaultProps = {
      ...DEFAULT_PROPS_MAP
    };
    let values = this.props.component.getEditablePropsValues(Object.keys(this._defaultProps));
    return {
      ...values,
      background: values.background
    };
  },
  //@@viewOff:reactLifeCycle

  //@@viewOn:interface
  getPropsToSave() {
    return this._getPropsToSave();
  },
  //@@viewOff:interface

  //@@viewOn:overridingMethods
  //@@viewOff:overridingMethods

  //@@viewOn:private
  // props actions
  _onEndEditation() {
    this.props.component.endEditation(this._getPropsToSave());
  },
  _getPropsToSave(state = this.state) {
    // unused vars are here just to separate them from the result
    // eslint-disable-next-line no-unused-vars
    let {
      background,
      children,
      content,
      ...result
    } = state;
    for (let propName in DEFAULT_PROPS_MAP) {
      if (result[propName] !== undefined && result[propName] === DEFAULT_PROPS_MAP[propName]) {
        result[propName] = undefined;
      }
    }
    return result;
  },
  // change state handlers
  _changeColorSchema(opt) {
    this.setState({
      colorSchema: opt.value
    }, () => {
      this.props.component.saveEditation({
        colorSchema: !opt.value || opt.value === "default" ? undefined : opt.value
      });
    });
  },
  _toggleBackground() {
    this.setState(state => ({
      background: !state.background
    }), () => {
      this.props.component.saveEditation({
        background: this.state.background
      });
    });
  },
  _getToolbarItems() {
    return [{
      type: _color_picker_js__WEBPACK_IMPORTED_MODULE_5__["default"],
      props: () => {
        return {
          value: this.state.colorSchema,
          onClick: this._changeColorSchema,
          tooltip: this.getLsiValue("colorSchemaTooltip")
        };
      }
    }];
  },
  _getToolbarSettings() {
    return [{
      value: this.state.background,
      onClick: this._toggleBackground,
      label: this.getLsiComponent("backgroundCheckboxLabel")
    }];
  },
  //@@viewOff:private

  //@@viewOn:render
  render() {
    return Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.BricksEditable.Toolbar, _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, this.getMainPropsToPass(), {
      onClose: this._onEndEditation,
      items: this._getToolbarItems(),
      settingsItems: this._getToolbarSettings()
    }), this.props.component.getChildren());
  }
  //@@viewOff:render
});

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Block);

/***/ }),

/***/ "./bricks/internal/color-picker.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ColorPicker": () => (/* binding */ ColorPicker),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../../node_modules/uu_appg01_devkit/node_modules/@babel/runtime/helpers/extends.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./bricks/internal/bricks-editable-ns.js");
/* harmony import */ var _css_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./bricks/internal/css.js");
/* harmony import */ var _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./bricks/internal/bricks-editable-lsi.js");
/* harmony import */ var _color_square_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./bricks/internal/color-square.js");

//@@viewOn:imports





//@@viewOff:imports

const COLOR_SCHEMAS = ["indigo", "blue", "light-blue", "cyan", "teal", "green", "light-green", "lime", "yellow", "amber", "orange", "deep-orange", "red", "pink", "purple", "deep-purple", "brown", "grey", "blue-grey", "black", "white"];
const ColorPicker = uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.VisualComponent.create({
  //@@viewOn:mixins
  mixins: [uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.BaseMixin],
  //@@viewOff:mixins

  //@@viewOn:statics
  statics: {
    tagName: _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__["default"].name("ColorPicker"),
    classNames: {
      main: () => _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__["default"].css("color-picker") + " " + _css_js__WEBPACK_IMPORTED_MODULE_3__["default"].css(`
        position: relative;

        & > .uu5-bricks-icon.uu5-bricks-icon.uu5-bricks-icon.uu5-bricks-icon {
          margin-right: -10px;
          position: relative;
          top: -2px;
        }

        & > div {
          position: absolute;
          bottom: -1px;
          left: 0;
        }
      `),
      popover: () => _css_js__WEBPACK_IMPORTED_MODULE_3__["default"].css(`
        width: 300px;
        color: ${uu5g04__WEBPACK_IMPORTED_MODULE_1__.Environment.colors.common.darkText};

        .uu5-bricks-popover-body {
          & > div:last-child {
            justify-content: center;
            max-width: 100%;
          }
        }
      `)
    },
    lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_4__["default"].colorPicker
  },
  //@@viewOff:statics

  //@@viewOn:propTypes
  propTypes: {
    value: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.string,
    onClick: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.func,
    colorSchema: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.string,
    bgStyle: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.oneOf(["filled", "outline", "transparent", "underline", "link"])
  },
  //@@viewOff:propTypes

  //@@viewOn:getDefaultProps
  getDefaultProps() {
    return {
      value: undefined,
      onClick: undefined,
      colorSchema: undefined,
      bgStyle: undefined
    };
  },
  //@@viewOff:getDefaultProps

  //@@viewOn:reactLifeCycle
  getInitialState() {
    return {
      open: false
    };
  },
  //@@viewOff:reactLifeCycle

  //@@viewOn:interface
  //@@viewOff:interface

  //@@viewOn:overridingMethods
  //@@viewOff:overridingMethods

  //@@viewOn:private
  _registerPopover(ref) {
    this._popover = ref;
  },
  _onChange(value) {
    this._togglePicker(undefined, () => {
      if (typeof this.props.onClick === "function") {
        this.props.onClick({
          component: this,
          value
        });
      }
    });
  },
  _togglePicker(component, setSateCallback) {
    this.setState(state => ({
      open: !state.open
    }), () => {
      if (this.state.open) {
        this._popover.open({
          // eslint-disable-next-line react/no-find-dom-node
          aroundElement: component.findDOMNode(),
          position: "bottom",
          onClose: () => this.setState({
            open: false
          })
        });
      } else {
        this._popover.close();
      }
      if (typeof setSateCallback === "function") {
        setSateCallback();
      }
    });
  },
  _getProps() {
    let props = this.getMainPropsToPass();
    props.onClick = this._togglePicker;
    props.tooltip = this.getLsiValue("colorSchemaTooltip");
    props.pressed = this.state.open;
    props.colorSchema = this.props.colorSchema;
    props.bgStyle = this.props.bgStyle;
    return props;
  },
  //@@viewOff:private

  //@@viewOn:render
  render() {
    return [Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Button, _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, this._getProps(), {
      key: "button"
    }), Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Icon, {
      icon: "mdi-palette",
      key: "icon"
    }), Uu5g05.Utils.Element.create(_color_square_js__WEBPACK_IMPORTED_MODULE_5__["default"], {
      className: "color-viewer",
      colorSchema: this.props.value,
      width: "24px",
      height: "4px",
      key: "color-viewer"
    })), Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Popover, {
      key: "color-schema-popover",
      ref_: this._registerPopover,
      controlled: false,
      className: this.getClassName("popover"),
      forceRender: true
    }, Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Div, null, Uu5g05.Utils.Element.create(_color_square_js__WEBPACK_IMPORTED_MODULE_5__["default"], {
      colorSchema: "default",
      onClick: this._onChange,
      label: this.getLsiValue("defaultColorSchema")
    })), Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Div, {
      style: {
        display: "flex",
        flexWrap: "wrap"
      }
    }, COLOR_SCHEMAS.map(colorSchema => {
      return Uu5g05.Utils.Element.create(_color_square_js__WEBPACK_IMPORTED_MODULE_5__["default"], {
        key: colorSchema,
        colorSchema: colorSchema,
        onClick: this._onChange
      });
    })))];
  }
  //@@viewOff:render
});

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ColorPicker);

/***/ }),

/***/ "./bricks/internal/color-square.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _css_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./bricks/internal/css.js");
/**
 * Copyright (C) 2021 Unicorn a.s.
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
 * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License at
 * <https://gnu.org/licenses/> for more details.
 *
 * You may obtain additional information at <https://unicorn.com> or contact Unicorn a.s. at address: V Kapslovne 2767/2,
 * Praha 3, Czech Republic or at the email: info@unicorn.com.
 */



const getColor = function (colorSchema = "grey", depth = colorSchema === "black" ? 900 : 500) {
  let color = uu5g04__WEBPACK_IMPORTED_MODULE_0__.Environment.colors[colorSchema] || uu5g04__WEBPACK_IMPORTED_MODULE_0__.Environment.colors.grey;
  return color["c" + depth] || color.c500;
};
const ColorSquare = props => {
  return Uu5g05.Utils.Element.create("div", {
    title: props.title || props.colorSchema,
    className: _css_js__WEBPACK_IMPORTED_MODULE_1__["default"].css(`
          display: flex;
          align-items: center;
          cursor: pointer;
        `) + " " + _css_js__WEBPACK_IMPORTED_MODULE_1__["default"].css(`
          line-height: ${props.height};

          div {
            width: ${props.width};
            height: ${props.height};
          }
        `)
    // eslint-disable-next-line react/jsx-no-bind
    ,
    onClick: () => {
      if (typeof props.onClick === "function") {
        props.onClick(props.colorSchema);
      }
    }
  }, Uu5g05.Utils.Element.create("div", {
    className: _css_js__WEBPACK_IMPORTED_MODULE_1__["default"].css(`
            margin: 4px;
            box-sizing: border-box;
          `) + " " + _css_js__WEBPACK_IMPORTED_MODULE_1__["default"].css(`background-color: ${getColor(props.colorSchema, props.depth)}`) + " " + _css_js__WEBPACK_IMPORTED_MODULE_1__["default"].css(`border: ${props.colorSchema === "white" ? "1px solid black" : "none"}`),
    title: props.colorSchema
  }), props.label);
};
ColorSquare.propTypes = {
  label: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string,
  depth: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.number,
  onClick: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.func,
  title: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string,
  colorSchema: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string,
  height: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string,
  width: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string
};
ColorSquare.defaultProps = {
  width: "32px",
  height: "32px"
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ColorSquare);

/***/ })

}]);