/*!
 * uu5g04 library with basic visual components
 * Copyright (C) 2021 Unicorn a.s.
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see Licenses - GNU Project <https://gnu.org/licenses/>.
 */
"use strict";
(this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] = this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] || []).push([["bricks_internal_panel-editable_js"],{

/***/ "./bricks/internal/panel-editable.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PanelEditable": () => (/* binding */ PanelEditable),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../../node_modules/uu_appg01_devkit/node_modules/@babel/runtime/helpers/extends.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./bricks/internal/bricks-editable-ns.js");
/* harmony import */ var _lsi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./bricks/lsi.js");
/* harmony import */ var _css_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./bricks/internal/css.js");
/* harmony import */ var _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./bricks/internal/bricks-editable-lsi.js");

let _ = t => t,
  _t,
  _t2;
/**
 * Copyright (C) 2021 Unicorn a.s.
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
 * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License at
 * <https://gnu.org/licenses/> for more details.
 *
 * You may obtain additional information at <https://unicorn.com> or contact Unicorn a.s. at address: V Kapslovne 2767/2,
 * Praha 3, Czech Republic or at the email: info@unicorn.com.
 */

//@@viewOn:imports





//@@viewOff:imports

const DEFAULT_PROPS_MAP = {
  header: null,
  mountContent: undefined
};
const editablePropsComponentSetup = [{
  name: "size",
  type: "switchSelector",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.sizeLabel,
  getProps: () => ({
    items: [{
      value: "s",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.sizeValueS
      })
    }, {
      value: "m",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.sizeValueM
      })
    }, {
      value: "l",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.sizeValueL
      })
    }, {
      value: "xl",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.sizeValueXL
      })
    }]
  })
}, [{
  name: "iconExpanded",
  type: "iconPicker",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconExpandedLabel
}, {
  name: "iconCollapsed",
  type: "iconPicker",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconCollapsedLabel
}], {
  name: "iconAlign",
  type: "switchSelector",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconAlignLabel,
  getProps: (props, componentProps) => ({
    disabled: !(componentProps.iconExpanded && componentProps.iconCollapsed),
    items: [{
      value: "left",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconAlignValueLeft
      })
    }, {
      value: "right",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconAlignValueRight
      })
    }, {
      value: "after",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.iconAlignValueAfter
      })
    }]
  })
}, [{
  name: "expanded",
  type: "bool",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.expandedLabel
}, {
  name: "alwaysExpanded",
  type: "bool",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.alwaysExpandedLabel
}]];
const editableDisplayPropsSetup = [{
  name: "colorSchemaHeader",
  type: "colorSchema",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.colorSchemaHeaderLabel
}, {
  name: "colorSchemaContent",
  type: "colorSchema",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.colorSchemaContentLabel
}, {
  name: "elevation",
  type: "switchSelector",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.elevationLabel,
  getProps: () => ({
    items: [{
      value: 0
    }, {
      value: 1
    }, {
      value: 2
    }, {
      value: 3
    }, {
      value: 4
    }, {
      value: 5
    }]
  })
}, {
  name: "borderRadius"
}, {
  name: "bgStyleHeader",
  type: "bgStyle",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.bgStyleHeaderLabel
}, {
  name: "bgStyleContent",
  type: "bgStyle",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.bgStyleContentLabel
}, {
  name: "openClick",
  type: "switchSelector",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.openClickLabel,
  getProps: ({
    value
  }) => ({
    value: value || "header",
    items: [{
      value: "header",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.openClickValueHeader
      })
    }, {
      value: "icon",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.openClickValueIcon
      })
    }]
  })
}, {
  name: "mountContent",
  type: "switchSelector",
  label: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.mountContentLabel,
  getProps: () => ({
    items: [{
      value: "onEachExpand",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.mountContentValueOnEachExpand
      })
    }, {
      value: "onFirstExpand",
      content: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.mountContentValueOnFirstExpand
      })
    }],
    message: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
      lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.mountContentDescription
    })
  })
}];
const editablePropsSetup = [{
  name: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
    lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.componentPropsLabel
  }),
  setup: editablePropsComponentSetup
}, {
  name: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
    lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common.displayPropsLabel
  }),
  setup: editableDisplayPropsSetup
}];
const PanelEditable = uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.VisualComponent.create({
  //@@viewOn:mixins
  mixins: [uu5g04__WEBPACK_IMPORTED_MODULE_1__.Common.BaseMixin],
  //@@viewOff:mixins

  //@@viewOn:statics
  statics: {
    tagName: _bricks_editable_ns_js__WEBPACK_IMPORTED_MODULE_2__["default"].name("PanelEditable"),
    classNames: {
      main: "panel-editable",
      switchSelector: _css_js__WEBPACK_IMPORTED_MODULE_4__["default"].css(_t || (_t = _`
        margin: -4px 0;
      `)),
      panel: _css_js__WEBPACK_IMPORTED_MODULE_4__["default"].css(_t2 || (_t2 = _`
        .uu5-bricks-panel-header-content {
          width: 100%;
        }
      `))
    },
    lsi: () => ({
      ..._bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel,
      ..._bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].common
    })
  },
  //@@viewOff:statics

  //@@viewOn:propTypes
  propTypes: {
    component: uu5g04__WEBPACK_IMPORTED_MODULE_1__.PropTypes.object.isRequired
  },
  //@@viewOff:propTypes

  //@@viewOn:getDefaultProps
  getDefaultProps() {
    return {
      component: null
    };
  },
  //@@viewOff:getDefaultProps

  //@@viewOn:reactLifeCycle
  getInitialState() {
    let props = this.props.component.getEditablePropsValues(Object.keys(DEFAULT_PROPS_MAP));
    return {
      ...props,
      mountContent: props.mountContent || "onEachExpand",
      editationModalOpen: false
    };
  },
  //@@viewOff:reactLifeCycle

  //@@viewOn:interface
  getPropsToSave() {
    return this._getPropsToSave();
  },
  //@@viewOff:interface

  //@@viewOn:overridingMethods
  //@@viewOff:overridingMethods

  //@@viewOn:private
  _onEndEditation() {
    this.props.component.endEditation(this._getPropsToSave());
  },
  _getPropsToSave(state = this.state) {
    let {
      editationModalOpen,
      ...result
    } = state;
    for (let propName in DEFAULT_PROPS_MAP) {
      if (result[propName] !== undefined && result[propName] === DEFAULT_PROPS_MAP[propName]) {
        result[propName] = undefined;
      }
    }
    return result;
  },
  _onChangeRenderedItem({
    value
  }) {
    this.setState({
      activeItemIndex: value
    });
  },
  _onCloseEditationModal(newProps) {
    if (newProps) {
      let newState = {
        ...newProps
      };
      delete newState.children;
      delete newState.content;
      this.setState({
        ...newState,
        editationModalOpen: false
      }, () => this.props.component.saveEditation(newProps));
    } else {
      this.setState({
        editationModalOpen: false
      });
    }
  },
  _onSettingsClick() {
    //EditationModal will use the content/children value of the component, but it's children can be already in edit mode, so their actual values can be lost, so endChildrenEditation and make sure that data are correct.
    this.props.component.endChildrenEditation();
    this.setState(state => ({
      editationModalOpen: !state.editationModalOpen
    }));
  },
  _renderMoreSettingsModal() {
    return Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.BricksEditable.Modal, {
      componentName: this.props.component.getTagName(),
      componentProps: {
        ...this.props.component.getEditablePropsValues(Object.keys(this.props.component.props)),
        mountContent: this.state.mountContent
      },
      componentPropsForm: editablePropsSetup,
      shown: this.state.editationModalOpen,
      onClose: this._onCloseEditationModal,
      header: Uu5g05.Utils.Element.create(_lsi_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
        lsi: _bricks_editable_lsi_js__WEBPACK_IMPORTED_MODULE_5__["default"].panel.modalHeader
      })
    });
  },
  _changeHeaderContent(opt) {
    this.setState({
      header: opt.value
    });
  },
  //@@viewOff:private

  //@@viewOn:render
  render() {
    let panelClassName = (this.state.className ? this.state.className + " " : "") + this.getClassName("panel");
    let {
      ref_,
      ...panelProps
    } = this.props.component.props;
    return Uu5g05.Utils.Element.create(Uu5g05.Fragment, null, Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.BricksEditable.Toolbar, _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, this.getMainPropsToPass(), {
      onClose: this._onEndEditation,
      onMoreSettingsClick: this._onSettingsClick
    }), [Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.Bricks.Panel, _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, panelProps, {
      editMode: false,
      className: panelClassName,
      key: "editablePanel",
      expanded: true,
      header: Uu5g05.Utils.Element.create(uu5g04__WEBPACK_IMPORTED_MODULE_1__.BricksEditable.Input, {
        value: this.state.header || "",
        placeholder: this.getLsi("headerPlaceholder"),
        onChange: this._changeHeaderContent,
        key: "headerInput",
        mainAttrs: {
          onClick: e => e.stopPropagation()
        }
      }, ({
        children
      }) => children)
    }), this.props.component.getChildren())]), this.state.editationModalOpen ? this._renderMoreSettingsModal() : null);
  }
  //@@viewOff:render
});

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PanelEditable);

/***/ })

}]);