/*!
 * uu5g04 library with basic visual components
 * Copyright (C) 2021 Unicorn a.s.
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see Licenses - GNU Project <https://gnu.org/licenses/>.
 */
"use strict";
(this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] = this["__webpack_jsonp_uu5g04_1_58_8_uu5g04_bricks"] || []).push([["bricks_video-hls_js"],{

/***/ "./bricks/video-hls.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VideoHls": () => (/* binding */ VideoHls),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../../node_modules/uu_appg01_devkit/node_modules/@babel/runtime/helpers/extends.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var hls_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("../../node_modules/hls.js/dist/hls.js");
/* harmony import */ var hls_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(hls_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _video_settings__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./bricks/video-settings.js");

/**
 * Copyright (C) 2021 Unicorn a.s.
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
 * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License at
 * <https://gnu.org/licenses/> for more details.
 *
 * You may obtain additional information at <https://unicorn.com> or contact Unicorn a.s. at address: V Kapslovne 2767/2,
 * Praha 3, Czech Republic or at the email: info@unicorn.com.
 */

//@@viewOn:imports



//@@viewOff:imports

const EMPTY_VIDEO_MP4 = "data:video/mp4;base64,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";
const VideoHls = uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.VisualComponent.create({
  displayName: "VideoHls",
  // for backward compatibility (test snapshots)
  //@@viewOn:mixins
  mixins: [(uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.BaseMixin)],
  //@@viewOff:mixins

  //@@viewOn:statics
  statics: {
    tagName: "UU5.Bricks.Video.Hls",
    errors: {
      hlsVideoNotSupported: "This browser does not support playing of HLS (HTTP Live Streaming) videos."
    }
  },
  //@@viewOff:statics

  //@@viewOn:propTypes
  propTypes: {
    videoAttrs: (uu5g04__WEBPACK_IMPORTED_MODULE_2___default().PropTypes.object),
    authenticate: (uu5g04__WEBPACK_IMPORTED_MODULE_2___default().PropTypes.bool),
    onBeforeChunkLoad: (uu5g04__WEBPACK_IMPORTED_MODULE_2___default().PropTypes.func)
  },
  //@@viewOff:propTypes

  //@@viewOn:getDefaultProps
  getDefaultProps() {
    return {
      videoAttrs: {},
      authenticate: false,
      onBeforeChunkLoad: null
    };
  },
  //@@viewOff:getDefaultProps

  //@@viewOn:reactLifeCycle
  getInitialState() {
    this._hls = null;
    this._video = null;
    this._preloaded = false;
    return {
      quality: null
    };
  },
  componentDidMount() {
    if (this._usesHlsLib()) {
      let {
        videoAttrs
      } = this.props;
      this._waitForToken(videoAttrs.src, () => {
        if (!this.isRendered()) return;
        let hlsConfig = {
          // debug: true, // FIXME Comment out.
          autoStartLoad: videoAttrs.autoPlay || videoAttrs.preload !== "none",
          xhrSetup: this._hlsXhrSetup,
          // 1. Try to load upto 1MB of the video (maxBufferSize)
          // 2. If it is less than 30s of video, then continue to load more fragments until 30s is reached (maxBufferLength).
          // 3. If trying to achieve step 1 and we already loaded >= 60s of video (maxMaxBufferLength) then stop loading fragments.
          maxBufferSize: 1 << 6,
          maxBufferLength: 30,
          maxMaxBufferLength: 60
        };
        let hls = this._hls = new (hls_js__WEBPACK_IMPORTED_MODULE_1___default())(hlsConfig);
        this._hls.on((hls_js__WEBPACK_IMPORTED_MODULE_1___default().Events.LEVEL_SWITCHING), (type, level) => {
          this.setState({
            quality: level !== null && level !== void 0 && level.height ? level.height + "p" : undefined
          });
        });
        if (videoAttrs.src && (videoAttrs.autoPlay || videoAttrs.preload !== "none")) {
          this._doPreload();
        }
        if (!hlsConfig.autoStartLoad || videoAttrs.preload === "metadata") {
          uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.EventListener.addEvent(this._video, "play", this.getId(), () => {
            let fn = () => hls.startLoad();
            let usedFn = !this._preloaded && this.props.videoAttrs.src ? () => this._doPreload(true, fn) : fn;
            usedFn();
          });
        }
      });
    } else if (!this._canPlayNativeHls()) {
      this.showError("hlsVideoNotSupported");
    }
  },
  componentDidUpdate(prevProps, prevState) {
    if (this.props.videoAttrs.src !== prevProps.videoAttrs.src) {
      if (this._preloaded) {
        this._waitForToken(this.props.videoAttrs.src, () => {
          this._hls.loadSource(this.props.videoAttrs.src);
        });
      }
    }
  },
  componentWillUnmount() {
    this._unmounted = true;
    uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.EventListener.removeEvent(this._video, "play", this.getId());
    if (this._hls) this._hls.destroy();
  },
  //@@viewOff:reactLifeCycle

  //@@viewOn:interface
  //@@viewOff:interface

  //@@viewOn:overriding
  //@@viewOff:overriding

  //@@viewOn:private
  _doPreload(startPlay = null, callback = null) {
    let {
      videoAttrs
    } = this.props;
    if (!this._preloaded) {
      this._preloaded = true;
      this._hls.attachMedia(this._video);
    }
    this._hls.loadSource(videoAttrs.src);
    this._hls.once((hls_js__WEBPACK_IMPORTED_MODULE_1___default().Events.MANIFEST_PARSED), () => {
      if (this._unmounted) return;
      if (typeof startPlay !== "boolean") startPlay = this.props.videoAttrs.autoPlay;
      if (startPlay) this._video.play();else if (videoAttrs.preload === "metadata") {
        // if preloading only metadata, stop downloading after first fragment
        this._hls.once((hls_js__WEBPACK_IMPORTED_MODULE_1___default().Events.FRAG_PARSED), () => this._hls.stopLoad());
      }
      this.setState({
        qualityList: (this._hls.levels || []).map(it => it.height + "p")
      });
      if (typeof callback === "function") callback();
    });
  },
  _hlsXhrSetup(xhr, url) {
    if (typeof this.props.onBeforeChunkLoad === "function") {
      let opts = {
        url
      };
      this.props.onBeforeChunkLoad(opts);
      if (opts.url !== url) {
        xhr.open("GET", opts.url, true);
      }
    }
    if (this.props.authenticate) {
      let session = uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.getSession();
      if (session && session.isAuthenticated() && uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.isTrustedDomain(url)) {
        if (this._authenticationHeaders) {
          for (let k in this._authenticationHeaders) {
            xhr.setRequestHeader(k, this._authenticationHeaders[k]);
          }
        }
      }
    }
  },
  _usesHlsLib() {
    return hls_js__WEBPACK_IMPORTED_MODULE_1___default().isSupported();
  },
  _canPlayNativeHls() {
    if (this.constructor._canPlayNativeHls === undefined) {
      this.constructor._canPlayNativeHls = document.createElement("video").canPlayType("application/vnd.apple.mpegurl");
    }
    return this.constructor._canPlayNativeHls;
  },
  _setVideoRef(ref) {
    this._video = ref;
  },
  _getAuthenticatedUrl(url, session) {
    let result = "";
    if (this._authenticatedUrl === url) result = this.state.authenticatedUrl;else if (this._authenticatingUrl !== url) {
      this._authenticatingUrl = url;
      let promise = this._urlPromise = this._computeAuthenticationData(url, session).then(({
        authenticatedUrl,
        headers
      }) => {
        if (this.isRendered() && promise === this._urlPromise) {
          delete this._authenticatingUrl;
          this._authenticatedUrl = url;
          this._authenticationHeaders = headers;
          this.setState({
            authenticatedUrl
          });
        }
      }, () => {
        delete this._authenticatingUrl;
      });
    }
    return result;
  },
  async _computeAuthenticationData(url, session) {
    let accessToken = await uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.Tools.getCallToken(url, session);
    let csrfToken = uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.Tools.getCsrfToken();
    let authenticatedUrl = await uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.Tools.getAuthenticatedUrl(url, session, accessToken, csrfToken);
    let headers = await uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Common.Tools.getAuthenticatedHeaders(url, session, accessToken, csrfToken);
    return {
      authenticatedUrl,
      headers
    };
  },
  async _waitForToken(url, callback) {
    if (this._authenticatedUrl === url) {
      // token is already prepared
      callback();
    } else if (this._authenticatingUrl === url) {
      // token is being prepared
      this._urlPromise.then(() => {
        if (this.isRendered()) callback();
      });
    } else {
      // there's no token used as it's not needed
      callback();
    }
  },
  _onQualityChange({
    value
  }) {
    let index = this.state.qualityList.indexOf(value);
    if (index >= 0) {
      this._hls.currentLevel = index;
    }
  },
  //@@viewOff:private

  //@@viewOn:render
  render() {
    let {
      videoAttrs = {}
    } = this.props;
    let {
      quality,
      qualityList
    } = this.state;
    let authnUrl;
    if (this.props.authenticate) {
      let session = uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.getSession();
      if (session && session.isAuthenticated() && uu5g04__WEBPACK_IMPORTED_MODULE_2___default().Environment.isTrustedDomain(videoAttrs.src)) {
        // NOTE We're getting authenticated URL even if using Hls (because we'll need token).
        authnUrl = this._getAuthenticatedUrl(videoAttrs.src, session);
      }
    }
    if (this._usesHlsLib()) {
      // don't propagate some props when using hls.js library (they're handled in JS instead of via DOM attrs)
      let {
        autoPlay,
        src,
        ...rest2
      } = videoAttrs; // eslint-disable-line no-unused-vars
      videoAttrs = rest2;
      // NOTE If using preload="none", <video> must still have "src" otherwise it's not possible to click Play.
      if (!this._preloaded && videoAttrs.preload === "none") videoAttrs.src = EMPTY_VIDEO_MP4;
    } else if (authnUrl) {
      videoAttrs.src = authnUrl;
    }
    return Uu5g05.Utils.Element.create(_video_settings__WEBPACK_IMPORTED_MODULE_3__["default"], _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, this.getMainPropsToPass(), {
      quality: quality,
      qualityList: qualityList,
      onQualityChange: this._onQualityChange
    }), Uu5g05.Utils.Element.create("video", _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({}, videoAttrs, {
      ref: this._setVideoRef
    })));
  }
  //@@viewOff:render
});

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (VideoHls);

/***/ }),

/***/ "./bricks/video-settings.js":
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VideoSettings": () => (/* binding */ VideoSettings),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("uu5g04");
/* harmony import */ var uu5g04__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(uu5g04__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _bricks_ns_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./bricks/bricks-ns.js");
/* harmony import */ var _internal_css_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./bricks/internal/css.js");
/* harmony import */ var _dropdown_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./bricks/dropdown.js");
/* harmony import */ var _icon_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./bricks/icon.js");
let _ = t => t,
  _t,
  _t2,
  _t3,
  _t4;
/**
 * Copyright (C) 2021 Unicorn a.s.
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public
 * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
 * version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License at
 * <https://gnu.org/licenses/> for more details.
 *
 * You may obtain additional information at <https://unicorn.com> or contact Unicorn a.s. at address: V Kapslovne 2767/2,
 * Praha 3, Czech Republic or at the email: info@unicorn.com.
 */

//@@viewOn:revision
// coded: Martin Mach, 07.09.2020
// reviewed: Petr Bišof, 14.09.2020
//@@viewOff:revision
//@@viewOn:imports






//@@viewOff:imports

const CLASS_NAMES = {
  main: () => _internal_css_js__WEBPACK_IMPORTED_MODULE_2__["default"].css(_t || (_t = _`
    position: relative;
  `)),
  wrapper: isIOS => {
    if (isIOS) {
      return _internal_css_js__WEBPACK_IMPORTED_MODULE_2__["default"].css(_t2 || (_t2 = _`
        color: rgba(255, 255, 255, 0.7);
        visibility: hidden;
        pointer-events: none;
        position: absolute;
        right: 75px;
        top: 6px;
        opacity: 0;
        transition: opacity 0.2s, visibility 0.2s;
        z-index: 1;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: rgba(135, 135, 135, 0.99);
        border-radius: 8px;
        padding: 4px;

        .${0}:hover > & {
          pointer-events: auto;
          visibility: visible;
          opacity: 1;
        }
      `), CLASS_NAMES.main());
    } else {
      return _internal_css_js__WEBPACK_IMPORTED_MODULE_2__["default"].css(_t3 || (_t3 = _`
        background: linear-gradient(0deg, transparent 0%, rgba(0,0,0,1) 100%);
        color: white;
        width: 100%;
        text-align: right;
        padding: 8px;

        visibility: hidden;
        pointer-events: none;
        position: absolute;
        top: 0;
        right: 0;
        opacity: 0;
        transition: opacity 0.2s, visibility 0.2s;
        z-index: 1;

        .${0}:hover > & {
          pointer-events: auto;
          visibility: visible;
          opacity: 1;
        }
      `), CLASS_NAMES.main());
    }
  },
  qualityPicker: isIOS => {
    if (isIOS) {
      return _internal_css_js__WEBPACK_IMPORTED_MODULE_2__["default"].css(_t4 || (_t4 = _`
        .uu5-bricks-dropdown-button {
          background-color: transparent !important;
          color: rgba(255, 255, 255, 0.7) !important;
          min-height: auto;
        }
      `));
    }
  }
};
const VideoSettings = uu5g04__WEBPACK_IMPORTED_MODULE_0__.Common.VisualComponent.create({
  //@@viewOn:mixins
  mixins: [uu5g04__WEBPACK_IMPORTED_MODULE_0__.Common.BaseMixin],
  //@@viewOff:mixins

  //@@viewOn:statics
  statics: {
    tagName: _bricks_ns_js__WEBPACK_IMPORTED_MODULE_1__["default"].name("VideoSettings"),
    classNames: CLASS_NAMES,
    lsi: () => uu5g04__WEBPACK_IMPORTED_MODULE_0__.Environment.Lsi.Bricks.video
  },
  //@@viewOff:statics

  //@@viewOn:propTypes
  propTypes: {
    quality: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string,
    qualityList: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.arrayOf(uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.string),
    onQualityChange: uu5g04__WEBPACK_IMPORTED_MODULE_0__.PropTypes.func
  },
  //@@viewOff:propTypes

  //@@viewOn:getDefaultProps
  getDefaultProps: function () {
    return {
      quality: null,
      qualityList: [],
      onQualityChange: null
    };
  },
  //@@viewOff:getDefaultProps

  //@@viewOn:reactLifeCycle
  //@@viewOff:reactLifeCycle

  //@@viewOn:interface
  //@@viewOff:interface

  //@@viewOn:overriding
  //@@viewOff:overriding

  //@@viewOn:private
  _onQualityItemClick(component, e) {
    let {
      onQualityChange
    } = this.props;
    if (typeof onQualityChange === "function") onQualityChange({
      value: component.props.value
    });
  },
  //@@viewOff:private

  //@@viewOn:render
  render() {
    let {
      quality,
      qualityList,
      children
    } = this.props;
    // isMobileIOS doesn't work since some newer version of iOS ...
    const isIOS = uu5g04__WEBPACK_IMPORTED_MODULE_0__.Common.Tools.isMobileIOS() || uu5g04__WEBPACK_IMPORTED_MODULE_0__.Common.Tools.isMac();
    return Uu5g05.Utils.Element.create("div", this.getMainAttrs(), Array.isArray(qualityList) && qualityList.length > 1 ? Uu5g05.Utils.Element.create("div", {
      className: this.getClassName().wrapper(isIOS)
    }, Uu5g05.Utils.Element.create(_dropdown_js__WEBPACK_IMPORTED_MODULE_3__["default"], {
      key: "q",
      className: this.getClassName().qualityPicker(isIOS),
      pullRight: true,
      baseline: true,
      bgStyle: "transparent",
      colorSchema: "white",
      label: quality || "",
      items: qualityList.map(value => ({
        onClick: this._onQualityItemClick,
        icon: value === quality ? "mdi-check" : undefined,
        value,
        label: Uu5g05.Utils.Element.create(Uu5g05.Fragment, null, Uu5g05.Utils.Element.create(_icon_js__WEBPACK_IMPORTED_MODULE_4__["default"], {
          icon: value === quality ? "mdi-check" : "mdi-blank"
        }), " " + value)
      }))
    })) : null, children);
  }
  //@@viewOff:render
});

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (VideoSettings);

/***/ })

}]);