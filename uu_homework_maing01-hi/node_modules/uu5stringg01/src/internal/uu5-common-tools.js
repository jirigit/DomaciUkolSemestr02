const REGEXP_XY = /[xy]/g;

const Tools = {};

Tools.REGEXP = {
  uu5string: /^\s*<uu5string\s*\/>/,
  uu5stringTemplate: /\$\{([0-9a-zA-Z.\-_]+)\s*(:\s*([0-9a-zA-Z.\-_ ()\[\]<>\\\/]+))?\}/,
  uu5json: /^\s*<uu5json\s*\/>/,
  uu5data: /^\s*<uu5data\s*\/>/,
  jsCode: /^(javascript:\s*)*/i,
};
Tools.generateId = (length) => {
  length = Math.max(length, 8);
  let uuidCore = "x4xxxyxx";
  const additionalCharLength = length - uuidCore.length;
  for (let i = 0; i < additionalCharLength; ++i) {
    if (i % 2 === 0) uuidCore = uuidCore + "x";
    else uuidCore = "x" + uuidCore;
  }

  return uuidCore.replace(REGEXP_XY, (char) => {
    let r = (Math.random() * 16) % 16 | 0;
    return (char === "x" ? r : (r & 0x3) | 0x8).toString(16);
  });
};

module.exports = Tools;
