if (process.env.NODE_ENV === "development") {
  const { Environment } = require("uu5g05");
  const { AppClient } = require("uu_appg01_core");
  const { Client } = AppClient;

  let callsBaseUri = Environment.get("callsBaseUri");
  if (callsBaseUri) {
    callsBaseUri = !callsBaseUri.endsWith("/") ? callsBaseUri + "/" : callsBaseUri;
    console.log(
      "Command calls will be redirected due to uu5Environment.callsBaseUri:\n\n" +
        Environment.appBaseUri +
        "\n->\n" +
        callsBaseUri
    );
    let override = (obj, key) => {
      let origFn = obj[key];
      if (typeof origFn === "function") {
        obj[key] = function (...args) {
          let uri = args[0] != null ? args[0] + "" : "";
          if (uri.startsWith(Environment.appBaseUri)) {
            args[0] = callsBaseUri + uri.slice(Environment.appBaseUri.length);
          }
          return origFn.call(this, ...args);
        };
      }
    };

    for (let method of ["get", "post", "cmdGet", "cmdPost"]) {
      override(Client, method);
      override(Client.prototype, method);
    }
  }
}
