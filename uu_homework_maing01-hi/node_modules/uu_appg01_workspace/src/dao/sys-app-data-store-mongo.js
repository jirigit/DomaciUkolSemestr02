"use strict";

const { DbConnection } = require("uu_appg01_datastore");
const { UuObjectDao } = require("uu_appg01_objectstore");

const CollectionHelper = require("./collection-helper");

class SysAppDataStoreMongo extends UuObjectDao {
  static async getListOfCollections(connectionString) {
    let db = await DbConnection.get(connectionString);
    return await db.listCollections().toArray();
  }

  static async dropCollection(connectionString, collectionName) {
    let db = await DbConnection.get(connectionString);
    let result = false;
    if (!CollectionHelper.isSystemCollection(collectionName)) {
      result = db.collection(collectionName).drop();
    }
    return result;
  }
}

module.exports = SysAppDataStoreMongo;
